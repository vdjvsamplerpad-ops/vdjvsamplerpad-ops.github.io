import{r as e,j as a}from"./ui-vendor-DQigaf8h.js";import{B as s,L as t,S as n}from"./index-DlAi4YWJ.js";import{X as l,r,C as d,b as i,x as o,f as c,P as x,S as m,e as h,y as p,W as u}from"./utils-vendor-Dm3UHTo7.js";import"./react-vendor-ClOJDe5F.js";import"./supabase-vendor-BjTeASSi.js";const g=[0,1,2,3],b=e=>{const a=Math.max(0,Math.floor(e/1e3));return`${Math.floor(a/60).toString().padStart(2,"0")}:${(a%60).toString().padStart(2,"0")}`},y=(e,a,s)=>Math.max(a,Math.min(s,e)),j=e=>({channelId:e,loadedPadRef:null,isPlaying:!1,isPaused:!1,playheadMs:0,durationMs:0,channelVolume:1,hotcuesMs:[null,null,null,null],hasLocalHotcueOverride:!1,collapsed:!1,waveformKey:null,pad:null});function v({open:v,onOpenChange:N,channelStates:f,channelCount:C,legacyPlayingPads:w,masterVolume:k,onMasterVolumeChange:M,onPadVolumeChange:I,onStopPad:P,onChannelVolumeChange:S,onStopChannel:V,onPlayChannel:$,onPauseChannel:E,onSeekChannel:T,onUnloadChannel:z,onArmChannelLoad:L,onCancelChannelLoad:H,armedLoadChannelId:B,onSetChannelHotcue:O,onTriggerChannelHotcue:q,onSaveChannelHotcuesToPad:R,onSetChannelCollapsed:U,stopMode:A,editMode:J,eqSettings:W,onEqChange:D,mixerEqCollapsed:F,onMixerEqCollapsedChange:K,theme:Q,windowWidth:X}){const G=X<768,Y=e.useMemo(()=>{const e=new Map;return f.forEach(a=>e.set(a.channelId,a)),e},[f]),Z=e.useMemo(()=>{const e=[];for(let a=1;a<=C;a+=1)e.push(Y.get(a)||j(a));return e},[C,Y]),_=e.useCallback((e,a)=>{var s;const t=Math.max(1,(null==(s=a.pad)?void 0:s.endMs)||a.durationMs||0);if(t<=1)return;const n=e.currentTarget.getBoundingClientRect(),l=y(e.clientX-n.left,0,n.width),r=n.width>0?l/n.width:0;T(a.channelId,r*t)},[T]),ee=e.useCallback((e,a)=>{if(J){const s=e.hotcuesMs[a];return void O(e.channelId,a,"number"==typeof s?null:Math.max(0,e.playheadMs||0))}q(e.channelId,a)},[J,O,q]),ae="dark"===Q?"bg-gray-800 border-gray-700 text-white":"bg-white border-gray-200 text-gray-900",se="dark"===Q?"bg-gray-900/70 border-gray-700":"bg-gray-50 border-gray-200";return a.jsxs("div",{className:`fixed inset-y-0 right-0 z-50 w-[28rem] max-w-[95vw] border-l shadow-2xl transition-transform duration-300 ${ae} ${v?"translate-x-0":"translate-x-full"}`,children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b "+("dark"===Q?"border-gray-700":"border-gray-200"),children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-sm font-semibold",children:"Mixer Engine V2"}),a.jsxs("p",{className:"text-[11px] "+("dark"===Q?"text-gray-400":"text-gray-500"),children:[C," loadable channels, stop mode: ",A]})]}),a.jsx(s,{variant:"outline",size:"icon",onClick:()=>N(!1),className:"dark"===Q?"h-8 w-8 border-red-500/60 bg-red-900/30 text-red-300 hover:bg-red-800/60":"h-8 w-8 border-red-300 bg-red-50 text-red-600 hover:bg-red-100",title:"Close Mixer",children:a.jsx(l,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"h-[calc(100vh-64px)] overflow-y-auto p-3 space-y-3",children:[J&&a.jsxs("div",{className:"rounded-md border px-3 py-2 text-xs font-semibold tracking-wide "+("dark"===Q?"border-amber-500 bg-amber-600/20 text-amber-200":"border-amber-400 bg-amber-50 text-amber-800"),children:["HOTCUE SET MODE ACTIVE",a.jsx("div",{className:"mt-1 text-[11px] font-normal "+("dark"===Q?"text-amber-100/90":"text-amber-700"),children:"Tap hotcue buttons to set/clear cues. Jump is disabled while Edit Mode is active."})]}),a.jsxs("section",{className:`rounded-lg border p-3 ${se}`,children:[a.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[a.jsxs(t,{className:"text-xs font-semibold flex items-center gap-2",children:[a.jsx(r,{className:"h-4 w-4"})," Master and EQ"]}),a.jsx(s,{type:"button",variant:"outline",size:"sm",className:"h-7 px-2",onClick:()=>K(!F),children:F?a.jsx(d,{className:"h-4 w-4"}):a.jsx(i,{className:"h-4 w-4"})})]}),!F&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:["Master Volume ",Math.round(100*k),"%"]}),a.jsx(n,{value:[100*k],onValueChange:([e])=>M(e/100),min:0,max:100,step:1})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:["High ",W.high>0?"+":"",W.high,"dB"]}),a.jsx(n,{value:[W.high],onValueChange:([e])=>D({...W,high:e}),min:-12,max:12,step:1})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:["Mid ",W.mid>0?"+":"",W.mid,"dB"]}),a.jsx(n,{value:[W.mid],onValueChange:([e])=>D({...W,mid:e}),min:-12,max:12,step:1})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:["Low ",W.low>0?"+":"",W.low,"dB"]}),a.jsx(n,{value:[W.low],onValueChange:([e])=>D({...W,low:e}),min:-12,max:12,step:1})]})]})]}),a.jsxs("section",{className:`rounded-lg border p-3 ${se}`,children:[a.jsxs(t,{className:"text-xs font-semibold flex items-center gap-2 mb-2",children:[a.jsx(o,{className:"h-4 w-4"}),"Channel Decks"]}),a.jsx("div",{className:"space-y-2",children:Z.map(e=>{var t;const l=Boolean(e.pad&&e.loadedPadRef),r=Math.max(1,(null==(t=e.pad)?void 0:t.endMs)||e.durationMs||0),o=y(e.playheadMs||0,0,r),u=r>0?o/r*100:0,j=B===e.channelId,v=null!==B&&B!==e.channelId;return a.jsxs("div",{className:"rounded-md border p-2 "+("dark"===Q?"border-gray-700 bg-gray-950/40":"border-gray-200 bg-white"),children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsxs("div",{className:"text-[11px] font-semibold "+("dark"===Q?"text-gray-200":"text-gray-700"),children:["CH ",e.channelId]}),a.jsx("div",{className:"min-w-0 flex-1 text-xs truncate",children:e.pad?`${e.pad.padName} (${e.pad.bankName})`:"No sampler loaded"}),a.jsx(s,{type:"button",variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>U(e.channelId,!e.collapsed),title:e.collapsed?"Expand channel":"Collapse channel",children:e.collapsed?a.jsx(d,{className:"h-4 w-4"}):a.jsx(i,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"mb-2 flex items-center gap-2",children:[a.jsx(s,{type:"button",variant:"outline",size:"sm",className:"h-8 px-3 "+(j?"dark"===Q?"border-emerald-400 bg-emerald-900/40 text-emerald-200":"border-emerald-400 bg-emerald-50 text-emerald-700":""),onClick:()=>{j?H():L(e.channelId)},children:j?"Waiting Pad...":"Load"}),a.jsx("div",{className:"text-[10px] "+("dark"===Q?"text-gray-400":"text-gray-500"),children:j?`Tap any highlighted pad to load into CH ${e.channelId}.`:v?`CH ${B} is waiting for pad selection.`:"Press Load, then tap a pad on the grid."})]}),a.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[a.jsx(s,{type:"button",variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>e.isPlaying?E(e.channelId):$(e.channelId),disabled:!l,title:e.isPlaying?"Pause":"Play",children:e.isPlaying?a.jsx(c,{className:"h-4 w-4"}):a.jsx(x,{className:"h-4 w-4"})}),a.jsx(s,{type:"button",variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>V(e.channelId),disabled:!l,title:"Stop",children:a.jsx(m,{className:"h-4 w-4"})}),a.jsx(s,{type:"button",variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>z(e.channelId),disabled:!l,title:"Unload",children:a.jsx(h,{className:"h-4 w-4"})}),a.jsxs("div",{className:"min-w-0 flex-1 text-[11px] text-right text-gray-500 dark:text-gray-400",children:[b(o)," / ",b(r)]})]}),a.jsxs("div",{className:"relative h-10 rounded border cursor-pointer overflow-hidden mb-2 "+("dark"===Q?"border-gray-700 bg-gray-900":"border-gray-300 bg-gray-100"),onClick:a=>_(a,e),title:l?"Seek using waveform":"Load a sampler first",children:[a.jsx("div",{className:"absolute inset-0 "+("dark"===Q?"bg-gradient-to-r from-blue-900/40 to-cyan-700/40":"bg-gradient-to-r from-blue-200 to-cyan-100")}),a.jsx("div",{className:"absolute inset-y-0 left-0 "+("dark"===Q?"bg-cyan-300/30":"bg-cyan-400/30"),style:{width:`${u}%`}}),a.jsx("div",{className:"absolute inset-y-0 w-[2px] "+("dark"===Q?"bg-cyan-300":"bg-cyan-600"),style:{left:`${u}%`}})]}),a.jsxs("div",{className:"space-y-2",children:[!e.collapsed&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"grid grid-cols-4 gap-1",children:g.map(t=>{const n=e.hotcuesMs[t],r="number"==typeof n;return a.jsx(s,{type:"button",variant:"outline",size:"sm",className:"h-8 px-0 text-[11px] "+(J?r?"border-amber-500 bg-amber-500/30 text-amber-100":"border-amber-400/70 text-amber-300":r?"border-cyan-400/80 text-cyan-400":""),onClick:()=>ee(e,t),disabled:!l,title:J?r?"Tap to clear cue":"Tap to set cue at current playhead":r?`Jump to ${b(n||0)}`:"No cue set",children:r?`C${t+1}`:"-"},`${e.channelId}-hotcue-${t}`)})}),a.jsx("div",{className:"text-[10px] text-gray-500 dark:text-gray-400",children:J?"Tap to SET/CLEAR cue.":"Tap to JUMP to cue."}),J&&l&&e.hasLocalHotcueOverride&&a.jsxs(s,{type:"button",variant:"outline",size:"sm",className:"h-8 w-full text-[11px]",onClick:()=>R(e.channelId),children:[a.jsx(p,{className:"mr-1 h-3.5 w-3.5"})," Save Channel Cues to Pad"]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between text-[10px] text-gray-500 dark:text-gray-400",children:[a.jsx("span",{children:"Channel Volume"}),a.jsxs("span",{children:[Math.round(100*e.channelVolume),"%"]})]}),a.jsx(n,{value:[100*e.channelVolume],min:0,max:100,step:1,onValueChange:([a])=>S(e.channelId,a/100)})]})]})]},e.channelId)})})]}),a.jsxs("section",{className:`rounded-lg border p-3 ${se}`,children:[a.jsxs(t,{className:"text-xs font-semibold flex items-center gap-2 mb-2",children:[a.jsx(u,{className:"h-4 w-4"})," Current Playing Sampler"]}),a.jsxs("div",{className:"space-y-2 max-h-56 overflow-y-auto",children:[0===w.length&&a.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"No pad-grid playback running."}),w.map(e=>{const t=Math.max(1,e.endMs||0),l=y(e.currentMs||0,0,t);return a.jsxs("div",{className:"rounded-md border p-2 "+("dark"===Q?"border-gray-700 bg-gray-950/40":"border-gray-200 bg-white"),children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("div",{className:"text-xs font-medium truncate",children:e.padName}),a.jsx("div",{className:"text-[10px] text-gray-500 dark:text-gray-400 truncate",children:e.bankName})]}),a.jsx(s,{type:"button",variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>P(e.padId),title:"Stop pad",children:a.jsx(m,{className:"h-4 w-4"})})]}),!G&&a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsxs("div",{className:"flex justify-between text-[10px] text-gray-500 dark:text-gray-400",children:[a.jsxs("span",{children:[b(l)," / ",b(t)]}),a.jsxs("span",{children:[Math.round(100*(e.effectiveVolume??e.volume)),"%"]})]}),a.jsx(n,{value:[100*e.volume],min:0,max:100,step:1,onValueChange:([a])=>I(e.padId,a/100)})]})]},e.padId)})]})]})]})]})}export{v as VolumeMixer};
//# sourceMappingURL=VolumeMixer-Jyskqlbo.js.map
