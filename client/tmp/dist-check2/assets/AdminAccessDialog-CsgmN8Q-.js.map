{"version":3,"file":"AdminAccessDialog-CsgmN8Q-.js","sources":["../../../src/components/ui/table.tsx","../../../src/components/ui/checkbox.tsx","../../../src/lib/admin-api.ts","../../../src/components/sampler/AdminAccessDialog.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport { cn } from '@/lib/utils';\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn('w-full caption-bottom text-sm', className)}\n      {...props}\n    />\n  </div>\n));\nTable.displayName = 'Table';\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn('[&_tr]:border-b', className)} {...props} />\n));\nTableHeader.displayName = 'TableHeader';\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn('[&_tr:last-child]:border-0', className)}\n    {...props}\n  />\n));\nTableBody.displayName = 'TableBody';\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      'border-t bg-muted/50 font-medium [&>tr]:last:border-b-0',\n      className,\n    )}\n    {...props}\n  />\n));\nTableFooter.displayName = 'TableFooter';\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      'border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted',\n      className,\n    )}\n    {...props}\n  />\n));\nTableRow.displayName = 'TableRow';\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      'h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]',\n      className,\n    )}\n    {...props}\n  />\n));\nTableHead.displayName = 'TableHead';\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\n      'p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]',\n      className,\n    )}\n    {...props}\n  />\n));\nTableCell.displayName = 'TableCell';\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn('mt-4 text-sm text-muted-foreground', className)}\n    {...props}\n  />\n));\nTableCaption.displayName = 'TableCaption';\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n};\n","import * as React from 'react';\nimport * as CheckboxPrimitive from '@radix-ui/react-checkbox';\nimport { Check } from 'lucide-react';\n\nimport { cn } from '@/lib/utils';\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      'peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground',\n      className,\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn('flex items-center justify-center text-current')}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n));\nCheckbox.displayName = CheckboxPrimitive.Root.displayName;\n\nexport { Checkbox };\n","import { edgeFunctionUrl, getAuthHeaders } from '@/lib/edge-api';\n\nexport type SortDirection = 'asc' | 'desc';\n\nexport interface AdminUser {\n  id: string;\n  email: string | null;\n  role: 'admin' | 'user';\n  display_name: string;\n  created_at: string | null;\n  last_sign_in_at: string | null;\n  banned_until: string | null;\n  is_banned: boolean;\n}\n\nexport interface AdminBank {\n  id: string;\n  title: string;\n  description: string;\n  color?: string | null;\n  created_at: string | null;\n  created_by: string | null;\n  access_count: number;\n}\n\nexport interface AccessEntry {\n  id: string;\n  user_id: string;\n  bank_id: string;\n  granted_at: string;\n  bank: {\n    id: string;\n    title: string;\n    description?: string | null;\n  } | null;\n}\n\nexport interface ActiveSessionRow {\n  session_key: string;\n  user_id: string;\n  email?: string | null;\n  device_fingerprint: string;\n  device_name?: string | null;\n  platform?: string | null;\n  browser?: string | null;\n  os?: string | null;\n  last_seen_at: string;\n}\n\nconst toQueryString = (params: Record<string, string | number | boolean | null | undefined>) => {\n  const query = new URLSearchParams();\n  Object.entries(params).forEach(([key, value]) => {\n    if (value === null || value === undefined || value === '') return;\n    query.set(key, String(value));\n  });\n  const text = query.toString();\n  return text ? `?${text}` : '';\n};\n\nconst callAdmin = async <T>(method: 'GET' | 'POST', route: string, body?: unknown): Promise<T> => {\n  const headers = await getAuthHeaders(true);\n  const resp = await fetch(edgeFunctionUrl('admin-api', route), {\n    method,\n    cache: 'no-store',\n    credentials: 'omit',\n    headers: {\n      ...headers,\n      ...(body ? { 'Content-Type': 'application/json' } : {}),\n    },\n    body: body ? JSON.stringify(body) : undefined,\n  });\n\n  const payload = await resp.json().catch(() => ({}));\n  const err = payload?.error || payload?.data?.error;\n  if (!resp.ok || payload?.ok === false) {\n    throw new Error(err || 'Admin API request failed');\n  }\n\n  return ((payload?.data ?? payload) as T);\n};\n\nexport const adminApi = {\n  async listUsers(input: {\n    q?: string;\n    page?: number;\n    perPage?: number;\n    sortBy?: 'display_name' | 'email' | 'created_at' | 'last_sign_in_at' | 'ban_status';\n    sortDir?: SortDirection;\n    includeAdmins?: boolean;\n  }) {\n    const query = toQueryString({\n      q: input.q,\n      page: input.page ?? 1,\n      perPage: input.perPage ?? 1000,\n      sortBy: input.sortBy ?? 'created_at',\n      sortDir: input.sortDir ?? 'desc',\n      includeAdmins: input.includeAdmins ?? false,\n    });\n    return callAdmin<{ users: AdminUser[]; total: number }>('GET', `users${query}`);\n  },\n\n  async createUser(input: { email: string; password: string; displayName?: string }) {\n    return callAdmin<{ user: AdminUser }>('POST', 'users/create', input);\n  },\n\n  async updateUserProfile(userId: string, input: { displayName: string }) {\n    return callAdmin<{ user: AdminUser }>('POST', `users/${userId}/update-profile`, input);\n  },\n\n  async deleteUser(userId: string) {\n    return callAdmin<{ userId: string }>('POST', `users/${userId}/delete`);\n  },\n\n  async banUser(userId: string, hours: number) {\n    return callAdmin<{ userId: string; banned_until: string }>('POST', `users/${userId}/ban`, { hours });\n  },\n\n  async unbanUser(userId: string) {\n    return callAdmin<{ userId: string; banned_until: null }>('POST', `users/${userId}/unban`);\n  },\n\n  async resetPassword(userId: string) {\n    return callAdmin<{ userId: string; email: string }>('POST', `users/${userId}/reset-password`);\n  },\n\n  async listBanks(input: {\n    q?: string;\n    sortBy?: 'title' | 'created_at' | 'access_count';\n    sortDir?: SortDirection;\n  }) {\n    const query = toQueryString({\n      q: input.q,\n      sortBy: input.sortBy ?? 'created_at',\n      sortDir: input.sortDir ?? 'desc',\n    });\n    return callAdmin<{ banks: AdminBank[]; total: number }>('GET', `banks${query}`);\n  },\n\n  async updateBank(bankId: string, input: { title: string; description?: string; color?: string | null }) {\n    return callAdmin<{ bank: AdminBank }>('POST', `banks/${bankId}/update`, input);\n  },\n\n  async deleteBank(bankId: string, revokeAll = true) {\n    return callAdmin<{ bankId: string; revokedAll: boolean }>('POST', `banks/${bankId}/delete`, { revokeAll });\n  },\n\n  async getUserAccess(userId: string) {\n    return callAdmin<{ userId: string; bankIds: string[]; access: AccessEntry[] }>('GET', `access/user/${userId}`);\n  },\n\n  async grantUserAccess(userId: string, bankIds: string[]) {\n    return callAdmin<{ userId: string; bankIds: string[]; grantedCount: number }>('POST', `access/user/${userId}/grant`, { bankIds });\n  },\n\n  async revokeUserAccess(userId: string, bankIds: string[]) {\n    return callAdmin<{ userId: string; bankIds: string[]; revokedCount: number }>('POST', `access/user/${userId}/revoke`, { bankIds });\n  },\n\n  async listActiveSessions(input: { q?: string; limit?: number }) {\n    const query = toQueryString({\n      q: input.q,\n      limit: input.limit ?? 300,\n      t: Date.now(),\n    });\n    return callAdmin<{ counts: { activeUsers: number; activeSessions: number }; sessions: ActiveSessionRow[]; total: number }>(\n      'GET',\n      `active-sessions${query}`,\n    );\n  },\n};\n","import * as React from 'react';\nimport { createPortal } from 'react-dom';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { ConfirmationDialog } from '@/components/ui/confirmation-dialog';\nimport { adminApi, type AccessEntry, type ActiveSessionRow, type AdminBank, type AdminUser, type SortDirection } from '@/lib/admin-api';\nimport { LED_COLOR_PALETTE } from '@/lib/led-colors';\nimport { Edit, Eye, EyeOff, Plus, RefreshCw, Shield, Trash2, UserPlus, Users } from 'lucide-react';\n\r\ninterface AdminAccessDialogProps {\r\n  open: boolean;\r\n  onOpenChange: (open: boolean) => void;\r\n  theme: 'light' | 'dark';\r\n}\r\n\r\ntype TabKey = 'assignments' | 'banks' | 'users' | 'active';\ntype UserSortBy = 'display_name' | 'email' | 'created_at' | 'last_sign_in_at' | 'ban_status';\ntype BankSortBy = 'title' | 'created_at' | 'access_count';\ntype AssignmentUserSortBy = 'display_name' | 'email' | 'created_at';\ntype AssignmentBankSortBy = 'title' | 'status' | 'access_count';\ntype ActiveSortBy = 'user_id' | 'email' | 'device_name' | 'platform' | 'last_seen_at';\nconst ACTIVE_SORT_STORAGE_KEY = 'vdjv-admin-active-sort';\n\r\nconst TABS: Array<{ key: TabKey; label: string }> = [\r\n  { key: 'assignments', label: 'Assignments' },\r\n  { key: 'banks', label: 'Banks' },\r\n  { key: 'users', label: 'Users' },\r\n  { key: 'active', label: 'Active' },\r\n];\r\n\r\nconst isUserBanned = (user: AdminUser | null): boolean => {\r\n  if (!user?.banned_until) return false;\r\n  const dt = new Date(user.banned_until).getTime();\r\n  return !Number.isNaN(dt) && dt > Date.now();\r\n};\r\n\r\nconst BANK_COLOR_NAMES = [\r\n  'Dim Gray',\r\n  'Gray',\r\n  'White',\r\n  'Red',\r\n  'Amber',\r\n  'Orange',\r\n  'Light Yellow',\r\n  'Yellow',\r\n  'Green',\r\n  'Aqua',\r\n  'Blue',\r\n  'Pure Blue',\r\n  'Violet',\r\n  'Purple',\r\n  'Hot Pink',\r\n  'Hot Pink 2',\r\n  'Deep Magenta',\r\n  'Deep Brown 2',\r\n];\r\n\r\nconst colorOptions = BANK_COLOR_NAMES\n  .map((name) => LED_COLOR_PALETTE.find((entry) => entry.name === name))\n  .filter(Boolean)\n  .map((entry) => ({ label: entry!.name, value: entry!.hex }));\n\ntype Notice = { id: string; variant: 'success' | 'error' | 'info'; message: string };\n\nfunction useNotices() {\n  const [notices, setNotices] = React.useState<Notice[]>([]);\n  const dismiss = React.useCallback((id: string) => {\n    setNotices((arr) => arr.filter((n) => n.id !== id));\n  }, []);\n  const pushNotice = React.useCallback((notice: Omit<Notice, 'id'>) => {\n    const id = typeof crypto !== 'undefined' && 'randomUUID' in crypto ? crypto.randomUUID() : String(Date.now() + Math.random());\n    setNotices((arr) => [{ id, ...notice }, ...arr]);\n    window.setTimeout(() => dismiss(id), 4000);\n  }, [dismiss]);\n  return { notices, pushNotice, dismiss };\n}\n\nfunction NoticesPortal({ notices, dismiss, theme }: { notices: Notice[]; dismiss: (id: string) => void; theme: 'light' | 'dark' }) {\n  if (typeof document === 'undefined') return null;\n  return createPortal(\n    <div className=\"fixed top-0 left-0 right-0 z-[2147483647] flex justify-center pointer-events-none\">\n      <div className=\"w-full max-w-xl px-3\">\n        {notices.map((notice) => (\n          <div\n            key={notice.id}\n            className={`pointer-events-auto mt-3 rounded-lg border px-4 py-2 shadow-lg ${\n              notice.variant === 'success'\n                ? (theme === 'dark' ? 'bg-green-600/90 border-green-500 text-white' : 'bg-green-600 border-green-700 text-white')\n                : notice.variant === 'error'\n                  ? (theme === 'dark' ? 'bg-red-600/90 border-red-500 text-white' : 'bg-red-600 border-red-700 text-white')\n                  : (theme === 'dark' ? 'bg-gray-800/90 border-gray-700 text-white' : 'bg-gray-900 border-gray-800 text-white')\n            }`}\n          >\n            <div className=\"flex items-start gap-3\">\n              <div className=\"flex-1 text-sm\">{notice.message}</div>\n              <button className=\"text-white/80 hover:text-white\" onClick={() => dismiss(notice.id)} aria-label=\"Dismiss\">Ã—</button>\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>,\n    document.body,\n  );\n}\n\r\nconst SortHeader = ({\r\n  title,\r\n  active,\r\n  direction,\r\n  onClick,\r\n}: {\r\n  title: string;\r\n  active: boolean;\r\n  direction: SortDirection;\r\n  onClick: () => void;\r\n}) => (\r\n  <button type=\"button\" onClick={onClick} className=\"inline-flex items-center gap-1 font-medium\">\r\n    {title}\r\n    <span className=\"text-xs opacity-70\">{active ? (direction === 'asc' ? '^' : 'v') : '*'}</span>\r\n  </button>\r\n);\r\n\r\nexport function AdminAccessDialog({ open, onOpenChange, theme }: AdminAccessDialogProps) {\n  const readStoredActiveSort = React.useCallback((): { sortBy: ActiveSortBy; sortDir: SortDirection } => {\n    if (typeof window === 'undefined') return { sortBy: 'last_seen_at', sortDir: 'desc' };\n    try {\n      const raw = localStorage.getItem(ACTIVE_SORT_STORAGE_KEY);\n      if (!raw) return { sortBy: 'last_seen_at', sortDir: 'desc' };\n      const parsed = JSON.parse(raw) as { sortBy?: string; sortDir?: string };\n      const validSortBy: ActiveSortBy[] = ['user_id', 'email', 'device_name', 'platform', 'last_seen_at'];\n      const sortBy = validSortBy.includes(parsed.sortBy as ActiveSortBy) ? (parsed.sortBy as ActiveSortBy) : 'last_seen_at';\n      const sortDir: SortDirection = parsed.sortDir === 'asc' ? 'asc' : 'desc';\n      return { sortBy, sortDir };\n    } catch {\n      return { sortBy: 'last_seen_at', sortDir: 'desc' };\n    }\n  }, []);\n\n  const initialActiveSort = React.useMemo(() => readStoredActiveSort(), [readStoredActiveSort]);\n  const [tab, setTab] = React.useState<TabKey>('assignments');\n  const [error, setError] = React.useState('');\n  const [info, setInfo] = React.useState('');\n  const { notices, pushNotice, dismiss } = useNotices();\n\r\n  const [users, setUsers] = React.useState<AdminUser[]>([]);\r\n  const [usersLoading, setUsersLoading] = React.useState(false);\r\n  const [usersQuery, setUsersQuery] = React.useState('');\r\n  const [usersSortBy, setUsersSortBy] = React.useState<UserSortBy>('created_at');\r\n  const [usersSortDir, setUsersSortDir] = React.useState<SortDirection>('desc');\r\n  const [assignmentUserSortBy, setAssignmentUserSortBy] = React.useState<AssignmentUserSortBy>('created_at');\r\n  const [assignmentUserSortDir, setAssignmentUserSortDir] = React.useState<SortDirection>('desc');\r\n\r\n  const [banks, setBanks] = React.useState<AdminBank[]>([]);\r\n  const [banksLoading, setBanksLoading] = React.useState(false);\r\n  const [banksQuery, setBanksQuery] = React.useState('');\r\n  const [banksSortBy, setBanksSortBy] = React.useState<BankSortBy>('created_at');\r\n  const [banksSortDir, setBanksSortDir] = React.useState<SortDirection>('desc');\r\n  const [assignmentBankSortBy, setAssignmentBankSortBy] = React.useState<AssignmentBankSortBy>('title');\r\n  const [assignmentBankSortDir, setAssignmentBankSortDir] = React.useState<SortDirection>('asc');\r\n\r\n  const [selectedUserId, setSelectedUserId] = React.useState('');\r\n  const [selectedBankIds, setSelectedBankIds] = React.useState<Set<string>>(new Set());\r\n  const [accessRows, setAccessRows] = React.useState<AccessEntry[]>([]);\r\n  const [accessLoading, setAccessLoading] = React.useState(false);\r\n  const [bulkLoading, setBulkLoading] = React.useState(false);\r\n\r\n  const [activeLoading, setActiveLoading] = React.useState(false);\n  const [activeCounts, setActiveCounts] = React.useState({ activeUsers: 0, activeSessions: 0 });\n  const [activeSessions, setActiveSessions] = React.useState<ActiveSessionRow[]>([]);\n  const [activeSortBy, setActiveSortBy] = React.useState<ActiveSortBy>(initialActiveSort.sortBy);\n  const [activeSortDir, setActiveSortDir] = React.useState<SortDirection>(initialActiveSort.sortDir);\n\r\n  const [createOpen, setCreateOpen] = React.useState(false);\r\n  const [createEmail, setCreateEmail] = React.useState('');\n  const [createPassword, setCreatePassword] = React.useState('');\n  const [showCreatePassword, setShowCreatePassword] = React.useState(false);\n  const [createDisplayName, setCreateDisplayName] = React.useState('');\n  const [createLoading, setCreateLoading] = React.useState(false);\r\n\r\n  const [detailsOpen, setDetailsOpen] = React.useState(false);\r\n  const [detailsUser, setDetailsUser] = React.useState<AdminUser | null>(null);\r\n  const [editDisplayName, setEditDisplayName] = React.useState('');\r\n  const [profileSaving, setProfileSaving] = React.useState(false);\n  const [banOpen, setBanOpen] = React.useState(false);\n  const [banHours, setBanHours] = React.useState(24);\n  const [deleteUserOpen, setDeleteUserOpen] = React.useState(false);\n  const [unbanOpen, setUnbanOpen] = React.useState(false);\n  const [resetPasswordOpen, setResetPasswordOpen] = React.useState(false);\n\r\n  const [editBankOpen, setEditBankOpen] = React.useState(false);\r\n  const [editBank, setEditBank] = React.useState<AdminBank | null>(null);\r\n  const [editBankTitle, setEditBankTitle] = React.useState('');\r\n  const [editBankDesc, setEditBankDesc] = React.useState('');\r\n  const [editBankColor, setEditBankColor] = React.useState('#3b82f6');\r\n  const [bankSaving, setBankSaving] = React.useState(false);\r\n  const [deleteBankOpen, setDeleteBankOpen] = React.useState(false);\r\n  const [deleteBank, setDeleteBank] = React.useState<AdminBank | null>(null);\r\n\r\n  const selectedUser = React.useMemo(() => users.find((u) => u.id === selectedUserId) || null, [users, selectedUserId]);\r\n  const grantedBankIds = React.useMemo(() => new Set(accessRows.map((r) => r.bank_id)), [accessRows]);\r\n\r\n  const assignmentUsers = React.useMemo(() => {\r\n    const sorted = [...users].sort((a, b) => {\r\n      if (assignmentUserSortBy === 'display_name') return String(a.display_name || '').localeCompare(String(b.display_name || ''), undefined, { sensitivity: 'base' });\r\n      if (assignmentUserSortBy === 'email') return String(a.email || '').localeCompare(String(b.email || ''), undefined, { sensitivity: 'base' });\r\n      const left = a.created_at ? new Date(a.created_at).getTime() : 0;\r\n      const right = b.created_at ? new Date(b.created_at).getTime() : 0;\r\n      return left - right;\r\n    });\r\n    return assignmentUserSortDir === 'asc' ? sorted : sorted.reverse();\r\n  }, [users, assignmentUserSortBy, assignmentUserSortDir]);\r\n\r\n  const assignmentBanks = React.useMemo(() => {\r\n    const sorted = [...banks].sort((a, b) => {\r\n      if (assignmentBankSortBy === 'title') {\r\n        return String(a.title || '').localeCompare(String(b.title || ''), undefined, { sensitivity: 'base' });\r\n      }\r\n      if (assignmentBankSortBy === 'status') {\r\n        const left = grantedBankIds.has(a.id) ? 1 : 0;\r\n        const right = grantedBankIds.has(b.id) ? 1 : 0;\r\n        return left - right;\r\n      }\r\n      return (a.access_count || 0) - (b.access_count || 0);\r\n    });\r\n    return assignmentBankSortDir === 'asc' ? sorted : sorted.reverse();\r\n  }, [banks, assignmentBankSortBy, assignmentBankSortDir, grantedBankIds]);\r\n\r\n  const activeUsersRows = React.useMemo(() => {\n    const map = new Map<string, ActiveSessionRow>();\n    activeSessions.forEach((row) => {\n      const prev = map.get(row.user_id);\n      if (!prev || new Date(row.last_seen_at).getTime() > new Date(prev.last_seen_at).getTime()) {\n        map.set(row.user_id, row);\n      }\n    });\n    const rows = Array.from(map.values());\n    rows.sort((a, b) => {\n      if (activeSortBy === 'user_id') return String(a.user_id || '').localeCompare(String(b.user_id || ''), undefined, { sensitivity: 'base' });\n      if (activeSortBy === 'email') return String(a.email || '').localeCompare(String(b.email || ''), undefined, { sensitivity: 'base' });\n      if (activeSortBy === 'device_name') return String(a.device_name || '').localeCompare(String(b.device_name || ''), undefined, { sensitivity: 'base' });\n      if (activeSortBy === 'platform') {\n        const left = [a.platform, a.browser, a.os].filter(Boolean).join(' / ');\n        const right = [b.platform, b.browser, b.os].filter(Boolean).join(' / ');\n        return left.localeCompare(right, undefined, { sensitivity: 'base' });\n      }\n      const left = new Date(a.last_seen_at).getTime();\n      const right = new Date(b.last_seen_at).getTime();\n      return left - right;\n    });\n    return activeSortDir === 'asc' ? rows : rows.reverse();\n  }, [activeSessions, activeSortBy, activeSortDir]);\n\n  React.useEffect(() => {\n    if (!error) return;\n    pushNotice({ variant: 'error', message: error });\n    setError('');\n  }, [error, pushNotice]);\n\n  React.useEffect(() => {\n    if (!info) return;\n    pushNotice({ variant: 'success', message: info });\n    setInfo('');\n  }, [info, pushNotice]);\n\r\n  const refreshUsers = React.useCallback(async () => {\r\n    setUsersLoading(true);\r\n    try {\r\n      const data = await adminApi.listUsers({\r\n        q: usersQuery,\r\n        perPage: 1000,\r\n        includeAdmins: false,\r\n        sortBy: usersSortBy,\r\n        sortDir: usersSortDir,\r\n      });\r\n      setUsers(data.users || []);\r\n      setError('');\r\n    } catch (e: any) {\r\n      setError(e?.message || 'Failed to load users');\r\n    } finally {\r\n      setUsersLoading(false);\r\n    }\r\n  }, [usersQuery, usersSortBy, usersSortDir]);\r\n\r\n  const refreshBanks = React.useCallback(async () => {\r\n    setBanksLoading(true);\r\n    try {\r\n      const data = await adminApi.listBanks({\r\n        q: banksQuery,\r\n        sortBy: banksSortBy,\r\n        sortDir: banksSortDir,\r\n      });\r\n      setBanks(data.banks || []);\r\n      setError('');\r\n    } catch (e: any) {\r\n      setError(e?.message || 'Failed to load banks');\r\n    } finally {\r\n      setBanksLoading(false);\r\n    }\r\n  }, [banksQuery, banksSortBy, banksSortDir]);\r\n\r\n  const refreshAccess = React.useCallback(async (userId: string) => {\r\n    if (!userId) {\r\n      setAccessRows([]);\r\n      return;\r\n    }\r\n    setAccessLoading(true);\r\n    try {\r\n      const data = await adminApi.getUserAccess(userId);\r\n      setAccessRows(data.access || []);\r\n      setError('');\r\n    } catch (e: any) {\r\n      setError(e?.message || 'Failed to load access');\r\n      setAccessRows([]);\r\n    } finally {\r\n      setAccessLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  const refreshActive = React.useCallback(async () => {\r\n    setActiveLoading(true);\r\n    try {\r\n      const data = await adminApi.listActiveSessions({ limit: 300 });\r\n      setActiveCounts({\r\n        activeUsers: Number(data?.counts?.activeUsers || 0),\r\n        activeSessions: Number(data?.counts?.activeSessions || 0),\r\n      });\r\n      setActiveSessions(data?.sessions || []);\r\n      setError('');\r\n    } catch (e: any) {\r\n      setError(e?.message || 'Failed to load active sessions');\r\n      setActiveCounts({ activeUsers: 0, activeSessions: 0 });\r\n      setActiveSessions([]);\r\n    } finally {\r\n      setActiveLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  React.useEffect(() => {\n    if (!open) return;\n    setError('');\n    setInfo('');\n    setSelectedBankIds(new Set());\n    setShowCreatePassword(false);\n    void refreshUsers();\n    void refreshBanks();\n    void refreshActive();\n  }, [open, refreshUsers, refreshBanks, refreshActive]);\n\n  React.useEffect(() => {\n    if (typeof window === 'undefined') return;\n    localStorage.setItem(\n      ACTIVE_SORT_STORAGE_KEY,\n      JSON.stringify({ sortBy: activeSortBy, sortDir: activeSortDir }),\n    );\n  }, [activeSortBy, activeSortDir]);\n\r\n  React.useEffect(() => {\r\n    if (!open) return;\r\n    if (!selectedUserId) {\r\n      setAccessRows([]);\r\n      return;\r\n    }\r\n    void refreshAccess(selectedUserId);\r\n  }, [open, selectedUserId, refreshAccess]);\r\n\r\n  React.useEffect(() => {\r\n    if (!open) return;\r\n    const timer = window.setInterval(() => void refreshActive(), 30000);\r\n    return () => window.clearInterval(timer);\r\n  }, [open, refreshActive]);\r\n\r\n  const toggleUserSort = (next: UserSortBy) => {\r\n    if (usersSortBy === next) setUsersSortDir((d) => (d === 'asc' ? 'desc' : 'asc'));\r\n    else {\r\n      setUsersSortBy(next);\r\n      setUsersSortDir(next === 'created_at' || next === 'last_sign_in_at' ? 'desc' : 'asc');\r\n    }\r\n  };\r\n\r\n  const toggleBankSort = (next: BankSortBy) => {\r\n    if (banksSortBy === next) setBanksSortDir((d) => (d === 'asc' ? 'desc' : 'asc'));\r\n    else {\r\n      setBanksSortBy(next);\r\n      setBanksSortDir(next === 'created_at' || next === 'access_count' ? 'desc' : 'asc');\r\n    }\r\n  };\r\n\r\n  const toggleAssignmentUserSort = (next: AssignmentUserSortBy) => {\r\n    if (assignmentUserSortBy === next) {\r\n      setAssignmentUserSortDir((d) => (d === 'asc' ? 'desc' : 'asc'));\r\n      return;\r\n    }\r\n    setAssignmentUserSortBy(next);\r\n    setAssignmentUserSortDir(next === 'created_at' ? 'desc' : 'asc');\r\n  };\r\n\r\n  const toggleAssignmentBankSort = (next: AssignmentBankSortBy) => {\n    if (assignmentBankSortBy === next) {\n      setAssignmentBankSortDir((d) => (d === 'asc' ? 'desc' : 'asc'));\n      return;\n    }\r\n    setAssignmentBankSortBy(next);\r\n    setAssignmentBankSortDir(next === 'access_count' ? 'desc' : 'asc');\n  };\n\n  const toggleActiveSort = (next: ActiveSortBy) => {\n    if (activeSortBy === next) {\n      setActiveSortDir((d) => (d === 'asc' ? 'desc' : 'asc'));\n      return;\n    }\n    setActiveSortBy(next);\n    setActiveSortDir(next === 'last_seen_at' ? 'desc' : 'asc');\n  };\n\r\n  const toggleSelectBank = (bankId: string) => {\r\n    setSelectedBankIds((prev) => {\r\n      const next = new Set(prev);\r\n      if (next.has(bankId)) next.delete(bankId);\r\n      else next.add(bankId);\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const selectedIds = Array.from(selectedBankIds);\r\n  const selectedGrantIds = selectedIds.filter((id) => !grantedBankIds.has(id));\r\n  const selectedRevokeIds = selectedIds.filter((id) => grantedBankIds.has(id));\r\n  const allGrantIds = banks.filter((b) => !grantedBankIds.has(b.id)).map((b) => b.id);\r\n  const allRevokeIds = banks.filter((b) => grantedBankIds.has(b.id)).map((b) => b.id);\r\n\r\n  const doGrant = async (bankIds: string[]) => {\r\n    if (!selectedUserId || bankIds.length === 0) return;\r\n    setBulkLoading(true);\r\n    try {\r\n      await adminApi.grantUserAccess(selectedUserId, bankIds);\r\n      setInfo(`Granted ${bankIds.length} bank(s).`);\r\n      setSelectedBankIds(new Set());\r\n      await Promise.all([refreshAccess(selectedUserId), refreshBanks()]);\r\n      setError('');\r\n    } catch (e: any) {\r\n      setError(e?.message || 'Grant failed');\r\n    } finally {\r\n      setBulkLoading(false);\r\n    }\r\n  };\r\n\r\n  const doRevoke = async (bankIds: string[]) => {\r\n    if (!selectedUserId || bankIds.length === 0) return;\r\n    setBulkLoading(true);\r\n    try {\r\n      await adminApi.revokeUserAccess(selectedUserId, bankIds);\r\n      setInfo(`Revoked ${bankIds.length} bank(s).`);\r\n      setSelectedBankIds(new Set());\r\n      await Promise.all([refreshAccess(selectedUserId), refreshBanks()]);\r\n      setError('');\r\n    } catch (e: any) {\r\n      setError(e?.message || 'Revoke failed');\r\n    } finally {\r\n      setBulkLoading(false);\r\n    }\r\n  };\r\n\r\n  const createUser = async () => {\r\n    const email = createEmail.trim().toLowerCase();\r\n    if (!email) {\r\n      setError('Email is required.');\r\n      return;\r\n    }\r\n    if (!createPassword || createPassword.length < 6) {\r\n      setError('Password must be at least 6 characters.');\r\n      return;\r\n    }\r\n    setCreateLoading(true);\r\n    try {\r\n      await adminApi.createUser({\r\n        email,\r\n        password: createPassword,\r\n        displayName: createDisplayName.trim() || undefined,\r\n      });\r\n      setCreateEmail('');\r\n      setCreatePassword('');\r\n      setCreateDisplayName('');\r\n      setCreateOpen(false);\r\n      setInfo('User created.');\r\n      await refreshUsers();\r\n      setError('');\r\n    } catch (e: any) {\r\n      setError(e?.message || 'Failed to create user');\r\n    } finally {\r\n      setCreateLoading(false);\r\n    }\r\n  };\r\n\r\n  const saveUserProfile = async () => {\r\n    if (!detailsUser) return;\r\n    const displayName = editDisplayName.trim();\r\n    if (!displayName) {\r\n      setError('Display name is required.');\r\n      return;\r\n    }\r\n    setProfileSaving(true);\r\n    try {\r\n      await adminApi.updateUserProfile(detailsUser.id, { displayName });\r\n      setDetailsUser((prev) => (prev ? { ...prev, display_name: displayName } : prev));\r\n      setInfo('User profile updated.');\r\n      await refreshUsers();\r\n      if (selectedUserId) await refreshAccess(selectedUserId);\r\n      setDetailsOpen(false);\r\n      setError('');\r\n    } catch (e: any) {\r\n      setError(e?.message || 'Failed to update profile');\r\n    } finally {\r\n      setProfileSaving(false);\r\n    }\r\n  };\r\n\r\n  const removeUser = async () => {\r\n    if (!detailsUser) return;\r\n    try {\r\n      await adminApi.deleteUser(detailsUser.id);\r\n      setDeleteUserOpen(false);\r\n      setDetailsOpen(false);\r\n      if (selectedUserId === detailsUser.id) setSelectedUserId('');\r\n      setInfo('User deleted.');\r\n      await Promise.all([refreshUsers(), refreshBanks()]);\r\n      setError('');\r\n    } catch (e: any) {\r\n      setError(e?.message || 'Failed to delete user');\r\n    }\r\n  };\r\n\r\n  const banUser = async () => {\r\n    if (!detailsUser) return;\r\n    try {\r\n      const result = await adminApi.banUser(detailsUser.id, banHours);\r\n      setDetailsUser((prev) => (prev ? { ...prev, banned_until: result.banned_until || prev.banned_until } : prev));\r\n      setBanOpen(false);\r\n      setInfo(`User banned for ${banHours} hour(s).`);\r\n      await refreshUsers();\r\n      setError('');\r\n    } catch (e: any) {\r\n      setError(e?.message || 'Failed to ban user');\r\n    }\r\n  };\r\n\r\n  const unbanUser = async () => {\r\n    if (!detailsUser) return;\r\n    try {\r\n      await adminApi.unbanUser(detailsUser.id);\r\n      setDetailsUser((prev) => (prev ? { ...prev, banned_until: null } : prev));\r\n      setInfo('User unbanned.');\r\n      await refreshUsers();\r\n      setError('');\r\n    } catch (e: any) {\r\n      setError(e?.message || 'Failed to unban user');\r\n    }\r\n  };\r\n\r\n  const sendReset = async () => {\r\n    if (!detailsUser) return;\r\n    try {\r\n      await adminApi.resetPassword(detailsUser.id);\r\n      setInfo('Password reset email sent.');\r\n      setError('');\r\n    } catch (e: any) {\r\n      setError(e?.message || 'Failed to send reset email');\r\n    }\r\n  };\r\n\r\n  const saveBank = async () => {\r\n    if (!editBank) return;\r\n    const title = editBankTitle.trim();\r\n    if (!title) {\r\n      setError('Bank title is required.');\r\n      return;\r\n    }\r\n    setBankSaving(true);\r\n    try {\r\n      await adminApi.updateBank(editBank.id, { title, description: editBankDesc.trim(), color: editBankColor });\r\n      setInfo('Bank updated.');\r\n      setEditBankOpen(false);\r\n      await refreshBanks();\r\n      setError('');\r\n    } catch (e: any) {\r\n      setError(e?.message || 'Failed to update bank');\r\n    } finally {\r\n      setBankSaving(false);\r\n    }\r\n  };\r\n\r\n  const removeBank = async () => {\r\n    if (!deleteBank) return;\r\n    try {\r\n      await adminApi.deleteBank(deleteBank.id, true);\r\n      setInfo(`Bank \"${deleteBank.title}\" deleted and access revoked.`);\r\n      setDeleteBankOpen(false);\r\n      setDeleteBank(null);\r\n      await Promise.all([refreshBanks(), selectedUserId ? refreshAccess(selectedUserId) : Promise.resolve()]);\r\n      setError('');\r\n    } catch (e: any) {\r\n      setError(e?.message || 'Failed to delete bank');\r\n    }\r\n  };\r\n\r\n  const openUserDetails = (user: AdminUser) => {\r\n    setDetailsUser(user);\r\n    setEditDisplayName(user.display_name || '');\r\n    setBanHours(24);\r\n    setDetailsOpen(true);\r\n  };\r\n\r\n  return (\n    <>\n      <NoticesPortal notices={notices} dismiss={dismiss} theme={theme} />\n\n      <Dialog open={open} onOpenChange={onOpenChange}>\n        <DialogContent aria-describedby={undefined} className={`w-[95vw] max-w-6xl h-[90vh] max-h-[90vh] overflow-hidden grid grid-rows-[auto_1fr] ${theme === 'dark' ? 'bg-gray-900 text-white' : 'bg-white text-gray-900'}`}>\n          <DialogHeader>\r\n            <DialogTitle className=\"flex items-center gap-2\">\r\n              <Shield className=\"w-4 h-4\" />\r\n              Admin Access\r\n            </DialogTitle>\r\n          </DialogHeader>\r\n          <div className=\"space-y-3 min-h-0 h-full overflow-hidden flex flex-col\">\r\n            <div className=\"flex flex-wrap gap-2\">\r\n              {TABS.map((t) => (\r\n                <Button key={t.key} size=\"sm\" variant={tab === t.key ? 'default' : 'outline'} onClick={() => setTab(t.key)}>\r\n                  {t.label}\r\n                </Button>\r\n              ))}\r\n            </div>\r\n            {tab === 'assignments' && (\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-3 h-full min-h-0 overflow-hidden\">\n                <div className=\"border rounded p-3 space-y-2 min-h-0 flex flex-col\">\n                  <div className=\"flex items-center justify-between\">\r\n                    <Label>Select User</Label>\r\n                    <div className=\"flex items-center gap-1\">\r\n                      <Button size=\"sm\" variant={assignmentUserSortBy === 'created_at' ? 'secondary' : 'outline'} onClick={() => toggleAssignmentUserSort('created_at')}>\r\n                        Newest\r\n                      </Button>\r\n                      <Button size=\"sm\" variant=\"outline\" onClick={() => void refreshUsers()} disabled={usersLoading}>\r\n                        <RefreshCw className={`w-4 h-4 ${usersLoading ? 'animate-spin' : ''}`} />\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                  <Input value={usersQuery} onChange={(e) => setUsersQuery(e.target.value)} placeholder=\"Search users...\" onKeyDown={(e) => e.key === 'Enter' && void refreshUsers()} />\r\n                  <div className=\"flex-1 min-h-0 overflow-auto border rounded\">\r\n                    <Table className=\"table-fixed\">\n                      <TableHeader>\r\n                        <TableRow>\r\n                          <TableHead><SortHeader title=\"User\" active={assignmentUserSortBy === 'display_name'} direction={assignmentUserSortDir} onClick={() => toggleAssignmentUserSort('display_name')} /></TableHead>\r\n                          <TableHead><SortHeader title=\"Email\" active={assignmentUserSortBy === 'email'} direction={assignmentUserSortDir} onClick={() => toggleAssignmentUserSort('email')} /></TableHead>\r\n                        </TableRow>\r\n                      </TableHeader>\r\n                      <TableBody>\r\n                        {assignmentUsers.map((u) => (\r\n                          <TableRow key={u.id} className={`cursor-pointer ${selectedUserId === u.id ? (theme === 'dark' ? 'bg-gray-800' : 'bg-gray-100') : ''}`} onClick={() => setSelectedUserId(u.id)}>\r\n                            <TableCell className=\"max-w-[200px] truncate\" title={u.display_name}>{u.display_name}</TableCell>\n                            <TableCell className=\"max-w-[220px] truncate\" title={u.email || ''}>{u.email || '-'}</TableCell>\n                          </TableRow>\r\n                        ))}\r\n                        {!usersLoading && assignmentUsers.length === 0 && <TableRow><TableCell colSpan={2} className=\"text-center py-3 opacity-70\">No users</TableCell></TableRow>}\r\n                      </TableBody>\r\n                    </Table>\r\n                  </div>\r\n                </div>\r\n                <div className=\"border rounded p-3 space-y-2 min-h-0 flex flex-col\">\r\n                  <div className=\"text-sm\">\r\n                    <div className=\"font-medium\">Bank Access</div>\r\n                    <div className=\"text-xs opacity-70\">\r\n                      {accessLoading\r\n                        ? 'Loading access...'\r\n                        : selectedUser\r\n                          ? `${selectedUser.display_name} (${selectedUser.email || 'no email'})`\r\n                          : 'Select a user first'}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex flex-wrap gap-2\">\r\n                    <Button size=\"sm\" onClick={() => void doGrant(selectedGrantIds)} disabled={!selectedUserId || selectedGrantIds.length === 0 || bulkLoading}>Grant Selected ({selectedGrantIds.length})</Button>\r\n                    <Button size=\"sm\" variant=\"outline\" onClick={() => void doRevoke(selectedRevokeIds)} disabled={!selectedUserId || selectedRevokeIds.length === 0 || bulkLoading}>Revoke Selected ({selectedRevokeIds.length})</Button>\r\n                    <Button size=\"sm\" variant=\"secondary\" onClick={() => void doGrant(allGrantIds)} disabled={!selectedUserId || allGrantIds.length === 0 || bulkLoading}>Grant All ({allGrantIds.length})</Button>\r\n                    <Button size=\"sm\" variant=\"outline\" onClick={() => void doRevoke(allRevokeIds)} disabled={!selectedUserId || allRevokeIds.length === 0 || bulkLoading}>Revoke All ({allRevokeIds.length})</Button>\r\n                  </div>\r\n                  <div className=\"flex-1 min-h-0 overflow-auto border rounded\">\r\n                    <Table className=\"table-fixed\">\n                      <TableHeader>\r\n                        <TableRow>\r\n                          <TableHead className=\"w-10\" />\r\n                          <TableHead><SortHeader title=\"Bank\" active={assignmentBankSortBy === 'title'} direction={assignmentBankSortDir} onClick={() => toggleAssignmentBankSort('title')} /></TableHead>\r\n                          <TableHead><SortHeader title=\"Status\" active={assignmentBankSortBy === 'status'} direction={assignmentBankSortDir} onClick={() => toggleAssignmentBankSort('status')} /></TableHead>\r\n                          <TableHead><SortHeader title=\"Access\" active={assignmentBankSortBy === 'access_count'} direction={assignmentBankSortDir} onClick={() => toggleAssignmentBankSort('access_count')} /></TableHead>\r\n                        </TableRow>\r\n                      </TableHeader>\r\n                      <TableBody>\r\n                        {assignmentBanks.map((b) => {\r\n                          const granted = grantedBankIds.has(b.id);\r\n                          return (\r\n                            <TableRow key={b.id}>\r\n                              <TableCell><Checkbox checked={selectedBankIds.has(b.id)} onCheckedChange={() => toggleSelectBank(b.id)} disabled={!selectedUserId} /></TableCell>\r\n                              <TableCell><div className=\"font-medium truncate max-w-[240px]\" title={b.title}>{b.title}</div><div className=\"text-xs opacity-70 truncate max-w-[240px]\" title={b.description || ''}>{b.description || '-'}</div></TableCell>\n                              <TableCell><span className={`text-xs px-2 py-1 rounded ${granted ? 'bg-emerald-600/20 text-emerald-500' : 'bg-gray-600/20 text-gray-500'}`}>{granted ? 'Granted' : 'Not granted'}</span></TableCell>\r\n                              <TableCell>{b.access_count}</TableCell>\r\n                            </TableRow>\r\n                          );\r\n                        })}\r\n                        {!banksLoading && assignmentBanks.length === 0 && <TableRow><TableCell colSpan={4} className=\"text-center py-3 opacity-70\">No banks</TableCell></TableRow>}\r\n                      </TableBody>\r\n                    </Table>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {tab === 'banks' && (\r\n              <div className=\"border rounded p-3 space-y-2 h-full min-h-0 flex flex-col overflow-hidden\">\r\n                <div className=\"flex gap-2 items-end\">\r\n                  <div className=\"flex-1 space-y-1\">\r\n                    <Label>Search Banks</Label>\r\n                    <Input value={banksQuery} onChange={(e) => setBanksQuery(e.target.value)} placeholder=\"Search title or description...\" onKeyDown={(e) => e.key === 'Enter' && void refreshBanks()} />\r\n                  </div>\r\n                  <Button variant=\"outline\" onClick={() => void refreshBanks()} disabled={banksLoading}>\r\n                    <RefreshCw className={`w-4 h-4 mr-1 ${banksLoading ? 'animate-spin' : ''}`} />\r\n                    Refresh\r\n                  </Button>\r\n                </div>\r\n                <div className=\"flex-1 min-h-0 overflow-auto border rounded\">\r\n                  <Table>\r\n                    <TableHeader>\r\n                      <TableRow>\r\n                        <TableHead>Color</TableHead>\r\n                        <TableHead><SortHeader title=\"Title\" active={banksSortBy === 'title'} direction={banksSortDir} onClick={() => toggleBankSort('title')} /></TableHead>\r\n                        <TableHead>Description</TableHead>\r\n                        <TableHead><SortHeader title=\"Created\" active={banksSortBy === 'created_at'} direction={banksSortDir} onClick={() => toggleBankSort('created_at')} /></TableHead>\r\n                        <TableHead><SortHeader title=\"Access\" active={banksSortBy === 'access_count'} direction={banksSortDir} onClick={() => toggleBankSort('access_count')} /></TableHead>\r\n                        <TableHead className=\"text-right\">Actions</TableHead>\r\n                      </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                      {banks.map((b) => (\r\n                        <TableRow key={b.id}>\r\n                          <TableCell><span className=\"inline-block w-5 h-5 rounded border\" style={{ backgroundColor: b.color || '#3b82f6' }} /></TableCell>\r\n                          <TableCell>{b.title}</TableCell>\r\n                          <TableCell className=\"max-w-[280px] truncate\" title={b.description || ''}>{b.description || '-'}</TableCell>\r\n                          <TableCell>{b.created_at ? new Date(b.created_at).toLocaleString() : '-'}</TableCell>\r\n                          <TableCell>{b.access_count}</TableCell>\r\n                          <TableCell className=\"text-right space-x-2\">\r\n                            <Button size=\"sm\" variant=\"outline\" onClick={() => { setEditBank(b); setEditBankTitle(b.title); setEditBankDesc(b.description || ''); setEditBankColor(b.color || '#3b82f6'); setEditBankOpen(true); }}><Edit className=\"w-4 h-4\" /></Button>\r\n                            <Button size=\"sm\" variant=\"destructive\" onClick={() => { setDeleteBank(b); setDeleteBankOpen(true); }}><Trash2 className=\"w-4 h-4\" /></Button>\r\n                          </TableCell>\r\n                        </TableRow>\r\n                      ))}\r\n                      {!banksLoading && banks.length === 0 && <TableRow><TableCell colSpan={6} className=\"text-center py-3 opacity-70\">No banks</TableCell></TableRow>}\r\n                    </TableBody>\r\n                  </Table>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {tab === 'users' && (\n              <div className=\"border rounded p-3 space-y-2 h-full min-h-0 flex flex-col overflow-hidden\">\n                <div className=\"flex gap-2 items-end\">\n                  <div className=\"flex-1 space-y-1\">\n                    <Label>Search Users</Label>\n                    <Input value={usersQuery} onChange={(e) => setUsersQuery(e.target.value)} placeholder=\"Search name, email, id...\" onKeyDown={(e) => e.key === 'Enter' && void refreshUsers()} />\n                  </div>\r\n                  <Button onClick={() => setCreateOpen(true)}><Plus className=\"w-4 h-4 mr-1\" />Add User</Button>\r\n                  <Button variant=\"outline\" onClick={() => void refreshUsers()} disabled={usersLoading}>\r\n                    <RefreshCw className={`w-4 h-4 mr-1 ${usersLoading ? 'animate-spin' : ''}`} />\r\n                    Refresh\n                  </Button>\n                </div>\n                <div className=\"flex-1 min-h-0 overflow-auto border rounded\">\n                  <Table>\n                    <TableHeader>\r\n                      <TableRow>\r\n                        <TableHead><SortHeader title=\"Display Name\" active={usersSortBy === 'display_name'} direction={usersSortDir} onClick={() => toggleUserSort('display_name')} /></TableHead>\r\n                        <TableHead><SortHeader title=\"Email\" active={usersSortBy === 'email'} direction={usersSortDir} onClick={() => toggleUserSort('email')} /></TableHead>\r\n                        <TableHead><SortHeader title=\"Created\" active={usersSortBy === 'created_at'} direction={usersSortDir} onClick={() => toggleUserSort('created_at')} /></TableHead>\r\n                        <TableHead><SortHeader title=\"Last Sign-In\" active={usersSortBy === 'last_sign_in_at'} direction={usersSortDir} onClick={() => toggleUserSort('last_sign_in_at')} /></TableHead>\r\n                        <TableHead><SortHeader title=\"Ban Status\" active={usersSortBy === 'ban_status'} direction={usersSortDir} onClick={() => toggleUserSort('ban_status')} /></TableHead>\r\n                        <TableHead className=\"text-right\">Actions</TableHead>\r\n                      </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                      {users.map((u) => (\r\n                        <TableRow key={u.id}>\r\n                          <TableCell>{u.display_name}</TableCell>\r\n                          <TableCell>{u.email || '-'}</TableCell>\r\n                          <TableCell>{u.created_at ? new Date(u.created_at).toLocaleString() : '-'}</TableCell>\r\n                          <TableCell>{u.last_sign_in_at ? new Date(u.last_sign_in_at).toLocaleString() : '-'}</TableCell>\r\n                          <TableCell><span className={`text-xs px-2 py-1 rounded ${isUserBanned(u) ? 'bg-red-600/20 text-red-500' : 'bg-emerald-600/20 text-emerald-500'}`}>{isUserBanned(u) ? 'Banned' : 'Active'}</span></TableCell>\r\n                          <TableCell className=\"text-right\"><Button size=\"sm\" variant=\"outline\" onClick={() => openUserDetails(u)}>Edit</Button></TableCell>\r\n                        </TableRow>\r\n                      ))}\r\n                      {!usersLoading && users.length === 0 && <TableRow><TableCell colSpan={6} className=\"text-center py-3 opacity-70\">No users</TableCell></TableRow>}\r\n                    </TableBody>\r\n                  </Table>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {tab === 'active' && (\n              <div className=\"border rounded p-3 space-y-2 h-full min-h-0 flex flex-col overflow-hidden\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <Label>Active Users</Label>\n                    <div className=\"text-xs opacity-70\">Non-admin users currently online.</div>\r\n                  </div>\r\n                  <Button variant=\"outline\" onClick={() => void refreshActive()} disabled={activeLoading}>\r\n                    <RefreshCw className={`w-4 h-4 mr-1 ${activeLoading ? 'animate-spin' : ''}`} />\r\n                    Refresh\n                  </Button>\n                </div>\n                <div className=\"grid grid-cols-2 gap-2\">\n                  <div className={`border rounded p-3 ${theme === 'dark' ? 'border-gray-700 bg-gray-800' : 'border-gray-200 bg-gray-50'}`}><div className=\"text-xs opacity-70\">Active Users</div><div className=\"text-xl font-semibold\">{activeCounts.activeUsers}</div></div>\n                  <div className={`border rounded p-3 ${theme === 'dark' ? 'border-gray-700 bg-gray-800' : 'border-gray-200 bg-gray-50'}`}><div className=\"text-xs opacity-70\">Active Sessions</div><div className=\"text-xl font-semibold\">{activeCounts.activeSessions}</div></div>\n                </div>\n                <div className=\"flex-1 min-h-0 overflow-auto border rounded\">\n                  <Table>\n                    <TableHeader>\n                      <TableRow>\n                        <TableHead><SortHeader title=\"User\" active={activeSortBy === 'user_id'} direction={activeSortDir} onClick={() => toggleActiveSort('user_id')} /></TableHead>\n                        <TableHead><SortHeader title=\"Email\" active={activeSortBy === 'email'} direction={activeSortDir} onClick={() => toggleActiveSort('email')} /></TableHead>\n                        <TableHead><SortHeader title=\"Device Name\" active={activeSortBy === 'device_name'} direction={activeSortDir} onClick={() => toggleActiveSort('device_name')} /></TableHead>\n                        <TableHead><SortHeader title=\"Platform / Browser / OS\" active={activeSortBy === 'platform'} direction={activeSortDir} onClick={() => toggleActiveSort('platform')} /></TableHead>\n                        <TableHead><SortHeader title=\"Last Seen\" active={activeSortBy === 'last_seen_at'} direction={activeSortDir} onClick={() => toggleActiveSort('last_seen_at')} /></TableHead>\n                      </TableRow>\n                    </TableHeader>\n                    <TableBody>\n                      {activeUsersRows.map((row) => (\n                        <TableRow key={row.user_id}>\r\n                          <TableCell className=\"font-mono text-xs\">{row.user_id.slice(0, 8)}...</TableCell>\r\n                          <TableCell>{row.email || '-'}</TableCell>\r\n                          <TableCell>{row.device_name || '-'}</TableCell>\r\n                          <TableCell>{[row.platform, row.browser, row.os].filter(Boolean).join(' / ') || '-'}</TableCell>\r\n                          <TableCell>{new Date(row.last_seen_at).toLocaleString()}</TableCell>\r\n                        </TableRow>\r\n                      ))}\r\n                      {!activeLoading && activeUsersRows.length === 0 && <TableRow><TableCell colSpan={5} className=\"text-center py-3 opacity-70\">No active users</TableCell></TableRow>}\r\n                    </TableBody>\r\n                  </Table>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      <Dialog open={createOpen} onOpenChange={setCreateOpen} useHistory={false}>\n        <DialogContent aria-describedby={undefined} className={theme === 'dark' ? 'bg-gray-900 text-white' : 'bg-white text-gray-900'}>\n          <DialogHeader>\r\n            <DialogTitle className=\"flex items-center gap-2\">\r\n              <UserPlus className=\"w-4 h-4\" />\r\n              Add User\r\n            </DialogTitle>\r\n          </DialogHeader>\r\n          <form\n            className=\"space-y-2\"\n            onSubmit={(event) => {\n              event.preventDefault();\n              void createUser();\n            }}\n          >\n            <div><Label>Email</Label><Input type=\"email\" autoComplete=\"email\" value={createEmail} onChange={(e) => setCreateEmail(e.target.value)} placeholder=\"user@example.com\" /></div>\n            <div className=\"space-y-1\">\n              <Label>Password</Label>\n              <div className=\"relative\">\n                <Input\n                  type={showCreatePassword ? 'text' : 'password'}\n                  value={createPassword}\n                  onChange={(e) => setCreatePassword(e.target.value)}\n                  placeholder=\"Minimum 6 characters\"\n                  autoComplete=\"new-password\"\n                />\n                <button\n                  type=\"button\"\n                  className=\"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-800\"\n                  onClick={() => setShowCreatePassword((v) => !v)}\n                  aria-label={showCreatePassword ? 'Hide password' : 'Show password'}\n                >\n                  {showCreatePassword ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n                </button>\n              </div>\n            </div>\n            <div><Label>Display Name</Label><Input value={createDisplayName} onChange={(e) => setCreateDisplayName(e.target.value)} placeholder=\"Optional\" /></div>\n            <div className=\"text-xs opacity-70\">User is auto-confirmed.</div>\n            <div className=\"flex gap-2\">\n              <Button type=\"submit\" className=\"flex-1\" disabled={createLoading}>{createLoading ? 'Creating...' : 'Create User'}</Button>\n              <Button type=\"button\" variant=\"outline\" onClick={() => setCreateOpen(false)}>Cancel</Button>\n            </div>\n          </form>\n        </DialogContent>\n      </Dialog>\n\r\n      <Dialog open={detailsOpen} onOpenChange={setDetailsOpen} useHistory={false}>\n        <DialogContent aria-describedby={undefined} className={theme === 'dark' ? 'bg-gray-900 text-white' : 'bg-white text-gray-900'}>\n          <DialogHeader>\r\n            <DialogTitle className=\"flex items-center gap-2\">\r\n              <Users className=\"w-4 h-4\" />\r\n              User Details\r\n            </DialogTitle>\r\n          </DialogHeader>\r\n          <div className=\"space-y-2\">\r\n            <div><Label>Display Name</Label><Input value={editDisplayName} onChange={(e) => setEditDisplayName(e.target.value)} /></div>\r\n            <div><Label>Email</Label><div>{detailsUser?.email || '-'}</div></div>\r\n            <div><Label>UID</Label><div className=\"font-mono text-xs break-all\">{detailsUser?.id || '-'}</div></div>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-2\">\n              <div><Label>Created</Label><div>{detailsUser?.created_at ? new Date(detailsUser.created_at).toLocaleString() : '-'}</div></div>\n              <div><Label>Last Sign-In</Label><div>{detailsUser?.last_sign_in_at ? new Date(detailsUser.last_sign_in_at).toLocaleString() : '-'}</div></div>\n            </div>\n            <div className=\"flex gap-2\">\n              <Button className=\"flex-1\" disabled={profileSaving} onClick={saveUserProfile}>{profileSaving ? 'Saving...' : 'Save Profile'}</Button>\n              <Button variant=\"outline\" className=\"flex-1\" onClick={() => setResetPasswordOpen(true)}>Send Password Reset</Button>\n            </div>\n            <div className=\"flex gap-2\">\n              {isUserBanned(detailsUser) ? <Button variant=\"outline\" className=\"flex-1\" onClick={() => setUnbanOpen(true)}>Unban User</Button> : <Button variant=\"outline\" className=\"flex-1\" onClick={() => setBanOpen(true)}>Ban User</Button>}\n              <Button variant=\"destructive\" className=\"flex-1\" onClick={() => setDeleteUserOpen(true)}>Delete User</Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\r\n\r\n      <Dialog open={banOpen} onOpenChange={setBanOpen} useHistory={false}>\n        <DialogContent aria-describedby={undefined} className={theme === 'dark' ? 'bg-gray-900 text-white' : 'bg-white text-gray-900'}>\n          <DialogHeader><DialogTitle>Ban User</DialogTitle></DialogHeader>\r\n          <div className=\"space-y-2\">\r\n            <div><Label>Ban Duration (hours)</Label><Input type=\"number\" min={1} max={8760} value={banHours} onChange={(e) => setBanHours(Math.max(1, Math.min(8760, Number(e.target.value) || 24)))} /></div>\r\n            <div className=\"text-xs opacity-70\">Ban until: {new Date(Date.now() + banHours * 60 * 60 * 1000).toLocaleString()}</div>\r\n            <div className=\"flex gap-2\">\r\n              <Button variant=\"destructive\" className=\"flex-1\" onClick={banUser}>Ban User</Button>\r\n              <Button variant=\"outline\" onClick={() => setBanOpen(false)}>Cancel</Button>\r\n            </div>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      <Dialog open={editBankOpen} onOpenChange={setEditBankOpen} useHistory={false}>\n        <DialogContent aria-describedby={undefined} className={theme === 'dark' ? 'bg-gray-900 text-white' : 'bg-white text-gray-900'}>\n          <DialogHeader><DialogTitle>Edit Bank</DialogTitle></DialogHeader>\n          <div className=\"space-y-2\">\n            <div><Label>Title</Label><Input value={editBankTitle} onChange={(e) => setEditBankTitle(e.target.value)} /></div>\n            <div><Label>Description</Label><textarea className={`w-full min-h-[120px] rounded border p-2 ${theme === 'dark' ? 'bg-gray-800 border-gray-700' : 'bg-white border-gray-300'}`} value={editBankDesc} onChange={(e) => setEditBankDesc(e.target.value)} /></div>\n            <div className=\"space-y-1\">\n              <Label>Bank Color</Label>\n              <div className=\"flex flex-wrap gap-1\">\n                {colorOptions.map((option) => (\n                  <button\n                    key={option.value}\n                    type=\"button\"\n                    title={option.label}\n                    className={`w-6 h-6 rounded-full border-2 ${editBankColor === option.value ? 'border-white scale-110' : 'border-gray-500'}`}\n                    style={{ backgroundColor: option.value }}\n                    onClick={() => setEditBankColor(option.value)}\n                  />\n                ))}\n              </div>\n            </div>\n            <div className=\"flex gap-2\">\n              <Button className=\"flex-1\" disabled={bankSaving} onClick={saveBank}>{bankSaving ? 'Saving...' : 'Save'}</Button>\n              <Button variant=\"outline\" onClick={() => setEditBankOpen(false)}>Cancel</Button>\n            </div>\n          </div>\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      <ConfirmationDialog open={deleteUserOpen} onOpenChange={setDeleteUserOpen} title=\"Delete User\" description=\"This will permanently delete the user account. This action cannot be undone.\" confirmText=\"Delete User\" variant=\"destructive\" onConfirm={removeUser} theme={theme} />\n      <ConfirmationDialog open={unbanOpen} onOpenChange={setUnbanOpen} title=\"Unban User\" description={`Unban \"${detailsUser?.display_name || detailsUser?.email || 'this user'}\"?`} confirmText=\"Unban User\" onConfirm={unbanUser} theme={theme} />\n      <ConfirmationDialog open={resetPasswordOpen} onOpenChange={setResetPasswordOpen} title=\"Send Password Reset\" description={`Send password reset email to \"${detailsUser?.email || 'this user'}\"?`} confirmText=\"Send Reset\" onConfirm={sendReset} theme={theme} />\n      <ConfirmationDialog open={deleteBankOpen} onOpenChange={setDeleteBankOpen} title=\"Delete Bank\" description={`Delete \"${deleteBank?.title || 'this bank'}\" and revoke all user access?`} confirmText=\"Delete Bank\" variant=\"destructive\" onConfirm={removeBank} theme={theme} />\n    </>\r\n  );\r\n}\r\n"],"names":["Table","React.forwardRef","className","props","ref","jsx","children","jsxRuntimeExports","cn","displayName","TableHeader","forwardRef","TableBody","TableRow","TableHead","TableCell","Checkbox","CheckboxPrimitive.Root","CheckboxPrimitive.Indicator","Check","toQueryString","params","query","URLSearchParams","Object","entries","forEach","key","value","set","String","text","toString","callAdmin","async","method","route","body","headers","getAuthHeaders","resp","fetch","edgeFunctionUrl","cache","credentials","JSON","stringify","payload","json","catch","err","error","_a","data","ok","Error","adminApi","listUsers","input","q","page","perPage","sortBy","sortDir","includeAdmins","userId","hours","listBanks","bankId","revokeAll","bankIds","listActiveSessions","limit","t","Date","now","ACTIVE_SORT_STORAGE_KEY","TABS","label","isUserBanned","user","banned_until","dt","getTime","Number","isNaN","colorOptions","map","name","LED_COLOR_PALETTE","find","entry","filter","Boolean","hex","NoticesPortal","notices","dismiss","theme","document","createPortal","notice","variant","jsxs","message","onClick","id","SortHeader","title","active","direction","type","AdminAccessDialog","open","onOpenChange","readStoredActiveSort","React.useCallback","window","raw","localStorage","getItem","parsed","parse","includes","initialActiveSort","React.useMemo","tab","setTab","React.useState","setError","info","setInfo","pushNotice","setNotices","arr","n","crypto","randomUUID","Math","random","setTimeout","useNotices","users","setUsers","usersLoading","setUsersLoading","usersQuery","setUsersQuery","usersSortBy","setUsersSortBy","usersSortDir","setUsersSortDir","assignmentUserSortBy","setAssignmentUserSortBy","assignmentUserSortDir","setAssignmentUserSortDir","banks","setBanks","banksLoading","setBanksLoading","banksQuery","setBanksQuery","banksSortBy","setBanksSortBy","banksSortDir","setBanksSortDir","assignmentBankSortBy","setAssignmentBankSortBy","assignmentBankSortDir","setAssignmentBankSortDir","selectedUserId","setSelectedUserId","selectedBankIds","setSelectedBankIds","Set","accessRows","setAccessRows","accessLoading","setAccessLoading","bulkLoading","setBulkLoading","activeLoading","setActiveLoading","activeCounts","setActiveCounts","useState","activeUsers","activeSessions","setActiveSessions","activeSortBy","setActiveSortBy","activeSortDir","setActiveSortDir","createOpen","setCreateOpen","createEmail","setCreateEmail","createPassword","setCreatePassword","showCreatePassword","setShowCreatePassword","createDisplayName","setCreateDisplayName","createLoading","setCreateLoading","detailsOpen","setDetailsOpen","detailsUser","setDetailsUser","editDisplayName","setEditDisplayName","profileSaving","setProfileSaving","banOpen","setBanOpen","banHours","setBanHours","deleteUserOpen","setDeleteUserOpen","unbanOpen","setUnbanOpen","resetPasswordOpen","setResetPasswordOpen","editBankOpen","setEditBankOpen","editBank","setEditBank","editBankTitle","setEditBankTitle","editBankDesc","setEditBankDesc","editBankColor","setEditBankColor","bankSaving","setBankSaving","deleteBankOpen","setDeleteBankOpen","deleteBank","setDeleteBank","selectedUser","useMemo","u","grantedBankIds","r","bank_id","assignmentUsers","sorted","sort","a","b","display_name","localeCompare","sensitivity","email","created_at","reverse","assignmentBanks","has","access_count","activeUsersRows","Map","row","prev","get","user_id","last_seen_at","rows","Array","from","values","device_name","left","platform","browser","os","join","right","React.useEffect","refreshUsers","e","refreshBanks","refreshAccess","getUserAccess","access","refreshActive","counts","_b","sessions","setItem","timer","setInterval","clearInterval","toggleUserSort","next","d","toggleBankSort","toggleAssignmentUserSort","toggleAssignmentBankSort","toggleActiveSort","selectedIds","selectedGrantIds","selectedRevokeIds","allGrantIds","allRevokeIds","doGrant","length","grantUserAccess","Promise","all","doRevoke","revokeUserAccess","Fragment","Dialog","DialogContent","DialogHeader","DialogTitle","Shield","Button","size","Label","disabled","RefreshCw","Input","onChange","target","placeholder","onKeyDown","colSpan","granted","checked","onCheckedChange","toggleSelectBank","delete","add","description","style","backgroundColor","color","toLocaleString","Edit","Trash2","Plus","last_sign_in_at","openUserDetails","slice","useHistory","UserPlus","onSubmit","event","preventDefault","trim","toLowerCase","createUser","password","autoComplete","v","EyeOff","Eye","Users","updateUserProfile","min","max","result","banUser","option","updateBank","ConfirmationDialog","confirmText","onConfirm","deleteUser","unbanUser","resetPassword","resolve"],"mappings":"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"}